setwd("C:/Users/Tanvi/Desktop/final semester/Regression Analysis/hw6")
data_B15 <- read.csv(paste(getwd(),"/data_table_B15.csv",sep = ""),header=T)
colnames(data_B15) <- c('x6','y', 'x1', 'x2', 'x3', 'x4', 'x5')
data_B15_fit <- lm(formula = data_B15$y ~ data_B15$x1 + data_B15$x2 + data_B15$x3 + data_B15$x4 + data_B15$x5, data = data_B15)
fit_all =regsubsets(y ~  x1 + x2 + x3 + x4 + x5, data=data_B15, nbest=10,really.big=T, intercept=T)
install.packages("leaps")
library(leaps)
fit_all =regsubsets(y ~  x1 + x2 + x3 + x4 + x5, data=data_B15, nbest=10,really.big=T, intercept=T)
install.packages("MASS")
library(MASS)
fit_all
model_fit_all =summary(fit_all)[[1]]
model_fit_all
summary(fit_all)
model_fit_all =summary(fit_all)[[1]]
RSQ =summary(fit_all)[[2]]
model_fit_all
RSQ
SSE=summary(fit_all)[[3]]
SSE
u
u
ADJR2 =summary(fit_all)[[4]]
Cp=summary(fit_all)[[5]]
BIC=summary(fit_all)[[6]]
fit_satistics =cbind(model_fit_all,RSQ,SSE,ADJR2,Cp,BIC)
fit_satistics
leaps(x=data_B15[,3:7], y=data_B15[,2], names=names(data_B15[,3:7]), method="Cp")
leaps(x=data_B15[,3:7], y=data_B15[,2], names=names(data_B15[,3:7]), method="adjr2")
datab15 <- read.csv(paste(getwd(),"/data_table_B15.csv",sep = ""),header=T)
data_req<-datab15[,c(2:7)]
mod_b15<-lm(MORT~.,data = data_req)
summary(mod_b15)
subs_mod<-regsubsets(MORT ~., data=data_req, really.big=T, intercept=T,nvmax =5)
??regsubsets
subs_mod<-regsubsets(MORT ~., data=data_req, really.big=T, intercept=T,nvmax =5)
summary(subs_mod)
summary(subs_mod)$adjr2
a<-which.max(summary(subs_mod)$adjr2)
a
adj_sub<-summary(subs_mod)$which[a,]
adj_sub
names(adj_sub[adj_sub==TRUE])
adj_sub
adj_sub<-names(adj_sub[adj_sub==TRUE])[2:length(names(adj_sub[adj_sub==TRUE]))]
adj_sub
max(summary(subs_mod)$adjr2)
plot(1:5,summary(subs_mod)$adjr2,xlab = "Number of variables",ylab = "Adj_R2",main = "Variation of AdjR2",ylim = c(0,1))
summary(subs_mod)$adjr2
points(a,max(summary(subs_mod)$adjr2),col='red')
library(calibrate)
plot(1:5,summary(subs_mod)$rss,xlab = "Number of variables",ylab = "RSS",main = "Variation of RSS")
points(a,min(summary(subs_mod)$rss),col='red')
textxy(a,min(summary(subs_mod)$rss),round(min(summary(subs_mod)$rss),2),cex = 0.75,offset = 0.6)
library(leaps)
tmp =regsubsets(MORT ~ PRECIP + EDUC + NONWHITE + SO2 + NOX, data=datab15 ,nbest=10,really.big=T, intercept=T)
tmp
names(summary(tmp))
almdl=summary(tmp)[[1]]
almdl
RSQ=summary(tmp)[[2]]
RSQ
step_both <- step(lm(MORT ~ ., data=data_req), scope=list(lower=~1, upper=mod_b15), direction='both')
summary(step_both)
step_both$anova # display results
mod_b15<-lm(MORT~.-NOX,data = data_req)
summary(mod_b15)
ck_ds<-cooks.distance(mod_b15)
ck_ds
plot(ck_ds,ylab="Cooks Distance",main = "Cooks D Plot")
top<-head(sort(ck_ds,decreasing = TRUE),6)
top
ck_ds_x<-as.numeric(names(top))
ck_ds_x
ck_ds_y<-top
min(top)
points(ck_ds_x,ck_ds_y,col='red')
textxy(ck_ds_x,ck_ds_y,ck_ds_x,cex=0.75)
mod_betas<-dfbeta(mod_b15)
mat<-which(abs(mod_betas)>(2/(sqrt(nrow(data_req)))),arr.ind = T)
mat
mod_fits<-dffits(mod_b15)
plot(mod_fits,ylab = "DFFITS",main = "DFFTITS PLOT")
mod_fits_x<-which(abs(mod_fits)>((2/sqrt(nrow(data_req)))*sqrt(2)))
mod_fits_x
mod_fits_y<-mod_fits[mod_fits_x]
mod_fits_y
points(mod_fits_x,mod_fits_y,col='red')
textxy(mod_fits_x,mod_fits_y,mod_fits_x,cex=0.75)
mod_b15_res.stures<-studres(mod_b15)
plot(mod_b15,1)
mod_b15.stdres <-rstandard(mod_b15)
hii2=hatvalues(mod_b15)             	## LEVERAGE POINTS
hii2
plot(lm.influence(mod_b15)$hat)
install.packages(c("tidyverse", "gapminder"))
setwd("C:/Users/Tanvi/Downloads")
setwd("~/Data Wrangling and Husbandary/W3")
